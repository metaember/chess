services:
  rust-chess:
    labels:
      - "traefik.enable=true"
      - "my_traefik.proxy_network=public"
      - "traefik.http.routers.rust-chess.rule=Host(`chess.chrls.io`)"
      - "traefik.http.routers.rust-chess.entrypoints=websecure"
      - "traefik.http.routers.rust-chess.tls.certresolver=cloudflare"
      - "traefik.http.routers.rust-chess.middlewares=rust-chess-auth,rust-chess-ratelimit"
      - "traefik.http.middlewares.rust-chess-auth.basicauth.users=${BASIC_AUTH_USERS}"
      - "traefik.http.middlewares.rust-chess-ratelimit.ratelimit.average=30"
      - "traefik.http.middlewares.rust-chess-ratelimit.ratelimit.burst=50"
      - "traefik.http.middlewares.rust-chess-ratelimit.ratelimit.period=1m"
      - "traefik.http.services.rust-chess.loadbalancer.server.port=3000"
    networks:
      - traefik-public

networks:
  traefik-public:
    external: true
